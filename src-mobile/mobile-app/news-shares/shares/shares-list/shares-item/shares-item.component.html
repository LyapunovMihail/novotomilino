<div *ngIf="share" class="news shares-view">

    <div class="shares-view__nav">
        <a routerLink="/news-shares/shares/list/1" class="shares-view__nav-back">Все новости</a>
    </div>

    <div class="shares-view__header">
        <div *ngIf="share.countdown && countDown(share.finish_date) >= 0" class="shares-view__header-finishing">
            {{countDown(share.finish_date) | sharesDayPipe}} до конца акции
        </div>
        <div *ngIf="share.countdown && countDown(share.finish_date) < 0" class="shares-view__header-finishing">
            Акция закончилась
        </div>
        <div class="shares-view__header-wrap">
            <button class="shares-view__header-btn shares-view__header-prev" [class.shares-view__header-btn-inactive]="!prevId" [routerLink]="['/news-shares/shares/list/' + indexNum + '/' + prevId]"></button>
            <button class="shares-view__header-btn shares-view__header-next" [class.shares-view__header-btn-inactive]="!nextId" [routerLink]="['/news-shares/shares/list/' + indexNum + '/' + nextId]"></button>
            <div class="shares-view__header-img">
                <img [src]="uploadsPath + share.mainImage">
            </div>
        </div>
        <div class="shares-view__content">
            <h1 class="shares-view__content-title">{{share.name}}</h1>
            <p class="shares-view__content-text">{{share.text}}</p>
            <p class="shares-view__content-date">{{share.created_at | date: 'dd.MM.yyyy' }}</p>
        </div>
    </div>


    <ul class="shares-view__flat flat-list">
        <li *ngFor="let b of share.body; index as blockIndex"
            [ngSwitch]="b.blockType">
            <ul *ngSwitchCase="'flats'"  class="flat-list__item-info">
                <li *ngFor="let flat of b.blockFlats; index as flatIndex" class="flat-list__item flat-list__item_info">
                    <a href="#" class="flat-list__item_link">
                        <div class="flat-list__item-img">
                            <!-- Изображение не работает -->
                            <img *ngSwitchCase="'image'" [src]="uploadsPath + b.blockImg.image">
                        </div>
    
                        <div class="flat-list__item-wrap">
                            <div class="flat-list__item-text flat-list__item-text_room">{{flat.room}}</div> <!-- Должна быть "комнатная" а не "комн." -->
                            <div class="flat-list__item-text flat-list__item-text_corpus">Секция {{flat.section}}</div> <!-- Должен быть корпус -->
                            <div class="flat-list__item-text flat-list__item-text_floor">Этаж {{flat.floor}}</div>
                        </div>
                        <div class="flat-list__item-wrap">
                            <div class="flat-list__item-text flat-list__item-text_space">{{flat.space}} м&#178;</div>
                            <div class="flat-list__item-price">
                                <div class="flat-list__item-text flat-list__item-text_price-not-sale">{{+flat.price - getDiscount(flat)}} &#8381;</div>
                                <div class="flat-list__item-text flat-list__item-text_price-sale">{{flat.price}} &#8381;</div>
                            </div>
                        </div>
                    </a>
                    <div class="flat-list__item-favorite"></div>
                </li>
            </ul>
        </li>
    </ul>
</div>

<!-- 
    TODO: Должны быть модалки квартиры и соответственно ипотека/забронировать (08.08.19)
 -->
<app-form-reserve *ngIf="setFlatData"
    (close)="isReserveFormOpen = $event; windowScrollLocker.unblock()"
    [isOpen]="isReserveFormOpen"
    [apartmentNumber]="selectFlat.number"
    [apartmentPrice]="selectFlat.price"
    [type]="'КВ'">
</app-form-reserve>
